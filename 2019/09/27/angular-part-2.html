<!doctype html>
<html lang="es-MX">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="shortcut icon" href="/assets/icon.png" type="image/x-icon">
  <link rel="shortcut icon" href="/assets/icon_large.png" type="image/png">

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-144585764-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-144585764-1');
  </script>
  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Angular + Firebase. Parte 2 | General nerdness</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Angular + Firebase. Parte 2" />
<meta name="author" content="Anya Reyes" />
<meta property="og:locale" content="es_MX" />
<meta name="description" content="Utilizamos Angular y Firebase y creamos una tasklist [Parte 2]" />
<meta property="og:description" content="Utilizamos Angular y Firebase y creamos una tasklist [Parte 2]" />
<link rel="canonical" href="https://anya.reyescon.de/2019/09/27/angular-part-2.html" />
<meta property="og:url" content="https://anya.reyescon.de/2019/09/27/angular-part-2.html" />
<meta property="og:site_name" content="General nerdness" />
<meta property="og:image" content="https://anya.reyescon.de/assets/2019-09-27/angular_firebase_2.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-09-27T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://anya.reyescon.de/assets/2019-09-27/angular_firebase_2.jpg" />
<meta property="twitter:title" content="Angular + Firebase. Parte 2" />
<meta name="twitter:site" content="@darkade" />
<meta name="twitter:creator" content="@Anya Reyes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Anya Reyes"},"dateModified":"2019-09-27T00:00:00+00:00","datePublished":"2019-09-27T00:00:00+00:00","description":"Utilizamos Angular y Firebase y creamos una tasklist [Parte 2]","headline":"Angular + Firebase. Parte 2","image":"https://anya.reyescon.de/assets/2019-09-27/angular_firebase_2.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://anya.reyescon.de/2019/09/27/angular-part-2.html"},"url":"https://anya.reyescon.de/2019/09/27/angular-part-2.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <header>
  <nav class="navbar navbar-dark bg-primary navbar-expand-lg">
    <div class="container-fluid">
      <span class="navbar-text w-50">
        <a class="" href="/">General nerdness</a>
        <span class="d-none d-md-block text-white text-bold"><small>Anya Reyes – Maths, RPGs, Boardgames &amp; Coding.</small></span>
      </span>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggle">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarToggle">
        <ul class="navbar-nav mb-2 mb-lg-0 ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/links/">Links</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/directory/">Directory</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

  <main class="container">
    <div class="row">
  <div class="offset-md-2 col-md-8 py-2">
    <article class="row py-1" lang="es-MX">
  <div class="col">
    <h1 class="my-2 h2"><a href="/2019/09/27/angular-part-2.html">Angular + Firebase. Parte 2</a></h1>
    <p class="text-end">Sep 27, 2019</p>

    <div class="row">
      <div class="col">
        <p><img src="/assets/2019-09-27/angular_firebase_2.jpg" alt="Cocinando con Angular + Firebase Parte 2"></p>

<p><em>Esta es la segunda parte de nuestra guía de Angular. Puedes leer la primera parte <a href="/2019/09/27/angular-part-1.html">aquí</a>.</em></p>

<p>La ocasión anterior vimos algunas cosas básicas de angular. Hoy para el platillo principal vamos a conectar nuestra task list a Firebase. Esto nos va a servir para hacer persistentes nuestras notas y aprender a utilizar una de las librearías más útiles de angular, <code class="language-plaintext highlighter-rouge">angularfire2</code>. Aprender a utilizar firebase también tiene la ventaja de que colocar tu app en Firebase va a ser gratuito a menos que tengas mucho tráfico.</p>

<!--more-->

<p><img src="/assets/2019-09-27/firestore.png" alt="Así queda en firestore"></p>

<h2 id="ingredientes">Ingredientes</h2>

<p>Solo vamos a agregar dos ingredientes a nuestra preparación anterior:</p>

<ul>
  <li><a href="https://firebase.google.com/" target="_blank" rel="noopener noreferrer">Firebase</a></li>
  <li>
<a href="https://github.com/angular/angularfire2" target="_blank" rel="noopener noreferrer">Angularfire</a> <code class="language-plaintext highlighter-rouge">^7.0.0</code>
</li>
</ul>

<p>Un topping excelente.</p>

<h2 id="preparación">Preparación</h2>

<h3 id="0-crea-un-nuevo-proyecto-y-base-de-datos-en-firebase">(0) Crea un nuevo proyecto y base de datos en Firebase</h3>

<p>Si ya tienes una cuenta en firebase y sabes como crear un proyecto y una base de datos de <code class="language-plaintext highlighter-rouge">firestore</code> puedes continuar al siguiente paso, si no sigue leyendo.</p>

<p><img src="/assets/2019-09-27/firebase_getstarted.png" alt="El sitio de Firebase circa 2019"></p>

<p>Vamos a comenzar por crear una <a href="https://firebase.google.com" target="_blank" rel="noopener noreferrer">nueva cuenta de firebase,</a> para lo cual necesitas una cuenta de google. Una vez en la consola:</p>

<ol>
  <li>Da click a <em>add project</em>.</li>
  <li>Nombra tu proyecto. Yo solo voy a utilziar <code class="language-plaintext highlighter-rouge">Task List</code>.</li>
  <li>Puedes o no activar analytics. Son muy útiles, pero no vamos a hablar de esa parte en este artículo.</li>
</ol>

<p>Tu consola se debe ve así una vez creado tu proyecto.
<img src="/assets/2019-09-27/firebase_console.png" alt="Consola de firebase para un proyecto recién creado"></p>

<ol>
  <li>En la parte de Database crea una base de datos de <code class="language-plaintext highlighter-rouge">Cloud Firestore</code> y selecciona <code class="language-plaintext highlighter-rouge">test mode</code> esto <em>va a hacer tu base de datos insegura,</em> pero solo vamos a probar. Para la región voy a escoger <code class="language-plaintext highlighter-rouge">nam5</code>, toma en cuenta que no podrás cambiar esta región una vez que confirmes.</li>
</ol>

<blockquote>
  <p>Antes de lanzar un proyecto a tus usuarios revisa con mucho detenimiento las <a href="https://firebase.google.com/docs/firestore/security/get-started" target="_blank" rel="noopener noreferrer"><em>security rules</em></a></p>
</blockquote>

<ol>
  <li>En project overview, da click al tercer botón <code class="language-plaintext highlighter-rouge">&lt;/&gt;</code> para agregar firebase a un proyecto web. Después de nombrar tu proyecto firebase te va a dar algo de código de javascript y un objeto que se ve así:</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">firebaseConfig</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apiKey</span><span class="p">:</span> <span class="dl">"</span><span class="s2">sGa7pO5vYZAaIE3kr3Do</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">authDomain</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613.firebaseapp.com</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">databaseURL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://test-project-a0613.firebaseio.com</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">projectId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">storageBucket</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613.appspot.com</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">messagingSenderId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">237742080605</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">appId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1:237742080605:web:B4A4CpnDletYOJqnndcl</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>Este objeto esta diseñado para ser público, normalmente lo colocarías dentro del <code class="language-plaintext highlighter-rouge">&lt;body&gt;</code> de tu webapp, de modo que tus usuarios podrán verlo, copiarlo y usarlo en sus propias webapps <strong>siempre.</strong> Por eso es importante que cuando lanzes un proyecto a producción te asegures de que las reglas de tu base de datos son seguras.</p>
</blockquote>

<p>Este es lo único que nos importa por el momento, porque es lo único que necesitamos para configurar <code class="language-plaintext highlighter-rouge">angularfire</code>.</p>

<blockquote>
  <p><em>Refrigera todos los ingredientes para que adquieran la consistencia adecuada al momento de cocinar.</em></p>
</blockquote>

<h3 id="1-creando-datos-de-prueba">(1) Creando datos de prueba</h3>

<p>De vuelta en Firestore vamos a crear una <em>collection</em> para tener datos hacia los cuales conectarnos.</p>

<p><img src="/assets/2019-09-27/firebase_newcollection.png" alt="tasks collection"></p>

<blockquote>
  <p><em>Con un procesador de alimentos integra todos los ingredientes hasta tener una pasta de consistencia cremosa.</em></p>
</blockquote>

<h3 id="2-instalando-y-configurando-angularfire2">(2) Instalando y configurando angularfire2</h3>

<p>Puedes instalar <code class="language-plaintext highlighter-rouge">angularfire</code> con este comando</p>

<p><code class="language-plaintext highlighter-rouge">npm install firebase @angular/fire --save</code></p>

<p>Una vez instalado necesitarás colocarlo en tu <code class="language-plaintext highlighter-rouge">src/app/app.module.ts</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">BrowserModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/platform-browser</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AppComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./app.component</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AngularFireModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/fire</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">environment</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../environments/environment</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">BrowserModule</span><span class="p">,</span>
    <span class="nx">AngularFireModule</span><span class="p">.</span><span class="nx">initializeApp</span><span class="p">(</span><span class="nx">environment</span><span class="p">.</span><span class="nx">firebase</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span> <span class="nx">AppComponent</span> <span class="p">],</span>
  <span class="na">bootstrap</span><span class="p">:</span> <span class="p">[</span> <span class="nx">AppComponent</span> <span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</code></pre></div></div>

<p>Y el objeto que guardamos antes en <code class="language-plaintext highlighter-rouge">/src/environments/environment.ts</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">production</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">firebase</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="dl">"</span><span class="s2">sGa7pO5vYZAaIE3kr3Do</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">authDomain</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613.firebaseapp.com</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">databaseURL</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://test-project-a0613.firebaseio.com</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">projectId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">storageBucket</span><span class="p">:</span> <span class="dl">"</span><span class="s2">test-project-a0613.appspot.com</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">messagingSenderId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">237742080605</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">appId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1:237742080605:web:B4A4CpnDletYOJqnndcl</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Con eso esta lista la configuración de firebase y podemos empezar a conectar nuestro código con la base de datos.</p>

<blockquote>
  <p><em>Hornea la pasta durante 20 minutos hasta que se redusca</em></p>
</blockquote>

<h3 id="3-conectando-nuestro-componente-la-base-de-datos">(3) Conectando nuestro componente la base de datos</h3>

<p>Como notarás los cambios que vamos a hacer a nuestro componente son muy pequeños. En el template solo vamos a agregar algo de funcionalidad y un solo cambio para hacer que funcione. Y en el componente vamos a cambiar los tipos de algunas variables.</p>

<p><code class="language-plaintext highlighter-rouge">src/app/tasklist/tasklist.component.ts</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NgForm</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/forms</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">AngularFirestore</span><span class="p">,</span> <span class="nx">AngularFirestoreCollection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/fire/firestore</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">rxjs</span><span class="dl">'</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">Task</span> <span class="p">{</span>
  <span class="nl">done</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">task</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">interface</span> <span class="nx">TaskId</span> <span class="kd">extends</span> <span class="nx">Task</span> <span class="p">{</span> <span class="nl">id</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="p">};</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">app-tasklist</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./tasklist.component.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">./tasklist.component.sass</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">TasklistComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>

  <span class="nl">tasksCollection</span><span class="p">:</span> <span class="nx">AngularFirestoreCollection</span><span class="o">&lt;</span><span class="nx">Task</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="nl">tasks</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">TaskId</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="nl">newtask</span><span class="p">:</span> <span class="nx">Task</span> <span class="o">=</span> <span class="p">{</span><span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">task</span><span class="p">:</span><span class="dl">''</span><span class="p">};</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">afs</span><span class="p">:</span> <span class="nx">AngularFirestore</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tasksCollection</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">afs</span><span class="p">.</span><span class="nx">collection</span><span class="o">&lt;</span><span class="nx">Task</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">tasks</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tasks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tasksCollection</span><span class="p">.</span><span class="nx">valueChanges</span><span class="p">({</span><span class="na">idField</span><span class="p">:</span> <span class="dl">'</span><span class="s1">id</span><span class="dl">'</span><span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">update</span><span class="p">(</span><span class="nx">task</span><span class="p">:</span> <span class="nx">TaskId</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">doc</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">afs</span><span class="p">.</span><span class="nx">doc</span><span class="o">&lt;</span><span class="nx">Task</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">tasks/</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">task</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">doc</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span> <span class="na">done</span><span class="p">:</span> <span class="nx">task</span><span class="p">.</span><span class="nx">done</span><span class="p">,</span> <span class="na">task</span><span class="p">:</span> <span class="nx">task</span><span class="p">.</span><span class="nx">task</span> <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">submit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tasksCollection</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">newtask</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">newtask</span> <span class="o">=</span> <span class="p">{</span><span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">task</span><span class="p">:</span><span class="dl">''</span><span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>Primero importamos <code class="language-plaintext highlighter-rouge">AngularFirestore</code>, <code class="language-plaintext highlighter-rouge">AngularFirestoreCollection</code> y <code class="language-plaintext highlighter-rouge">Observable</code> que vamos a ver con detenimiento acontinuación.</li>
  <li>
<code class="language-plaintext highlighter-rouge">tasksCollection: AngularFirestoreCollection&lt;Task&gt;;</code> es una <a href="https://github.com/angular/angularfire2/blob/master/docs/firestore/collections.md" target="_blank" rel="noopener noreferrer"><em>collection</em></a> y es el objeto que vamos a utilizar para conectarnos con Firestore.</li>
  <li>
<code class="language-plaintext highlighter-rouge">tasks: Observable&lt;TaskId[]&gt;;</code> Con esta linea creamos un Observable de tipo <code class="language-plaintext highlighter-rouge">TaskId[]</code>, que es un array dónde todos los elementos son de tipo <code class="language-plaintext highlighter-rouge">TaskId</code>
</li>
</ul>

<blockquote>
  <p>Esta última sintaxis parece compleja pero en el uso es muy cotidiano, si quieres saber más lee sobre <a href="https://www.typescriptlang.org/docs/handbook/generics.html" target="_blank" rel="noopener noreferrer">Generic Types</a>. En la práctica lo que estamos haciendo es <em>suscribirnos</em> a un evento que va a pasar: “En algún momento tasks va a tener un array de TaskId”</p>
</blockquote>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">constructor(private afs: AngularFirestore) { }</code> agrega como <a href="https://angular.io/guide/architecture-services" target="_blank" rel="noopener noreferrer"><em>service</em></a> un objeto local llamado <code class="language-plaintext highlighter-rouge">afs</code> que va ser nuestra interfáz con Firestore. No es necesario configurarlo más ya que toda su configuración esta en <code class="language-plaintext highlighter-rouge">app.module.ts</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">this.tasksCollection = this.afs.collection&lt;Task&gt;('tasks');</code> le pide a firestore una referencia hacia toda la <em>collection</em> que esta bajo ‘tasks’ en nuestra base de datos</li>
  <li>
<code class="language-plaintext highlighter-rouge">this.tasks = this.tasksCollection.valueChanges({idField: 'id'});</code> adquiere todos los valores que estan guardados en nuestra <em>collection</em> junto con sus respectivos id’s</li>
  <li>
<code class="language-plaintext highlighter-rouge">update(task: TaskId)</code> las lineas que estan en esta función le piden a Firestore una referencia al documento individual, al task que estamos modificando. Y entonces actualiza el documento. Lo hacemos de esta forma <code class="language-plaintext highlighter-rouge">{ done: task.done, task: task.task }</code> porque de otra manera estaríamos agregando el campo <code class="language-plaintext highlighter-rouge">id</code> a nuestro documento y no es necesario. ~Creo que esto se puede hacer de una mejor manera. Si se te ocurre alguna forma por favor deja un comentario.~</li>
  <li>
<code class="language-plaintext highlighter-rouge">this.tasksCollection.add(this.newtask);</code> agrega nuestro nuevo task a la <em>collection</em>
</li>
</ul>

<p>Las modificaciones a <code class="language-plaintext highlighter-rouge">src/app/tasklist/tasklist.component.html</code> son bastante simples.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li</span> <span class="na">*ngFor=</span><span class="s">"let task of tasks | async"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">(change)=</span><span class="s">"update(task)"</span> <span class="na">[(ngModel)]=</span><span class="s">"task.done"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">(change)=</span><span class="s">"update(task)"</span> <span class="na">[(ngModel)]=</span><span class="s">"task.task"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">disabled</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">(keyup.enter)=</span><span class="s">"submit()"</span> <span class="na">[(ngModel)]=</span><span class="s">"newtask.task"</span> <span class="na">placeholder=</span><span class="s">"Nuevo task"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">let task of tasks | async</code> agregamos <code class="language-plaintext highlighter-rouge">async</code>. Esto nos permite <em>esperar</em> a que se <em>resuelva</em> un observable. En otras palabras <code class="language-plaintext highlighter-rouge">tasks</code> va a conectarse al servidor de firebase y esto puede tomar tiempo; si no agregamos <code class="language-plaintext highlighter-rouge">async</code> el template devolvería un error en la consola.</li>
  <li>
<code class="language-plaintext highlighter-rouge">(change)=update(task)</code> mandamos a llamar la función <code class="language-plaintext highlighter-rouge">update()</code> cuando el checkbox o la caja de texto de cada task tiene algun cambio. Es importante que sea en el método <code class="language-plaintext highlighter-rouge">(change)</code> porque este se ejecuta cuando terminan los cambios son “un hecho”, a diferencia de <code class="language-plaintext highlighter-rouge">(click)</code> o <code class="language-plaintext highlighter-rouge">(keyup)</code>.</li>
</ul>

<blockquote>
  <p><em>Coloca directamente sobre el pay que horneamos anteriormente.</em></p>
</blockquote>

<hr>

<p>Y en realidad eso es todo. Como puedes ver los tasks que crees y modifiques se quedan guardados en tu base de datos y se reflejan instantaneamente en tu base de datos de firestore. Incluso si cambias un valor en la base de datos se va a reflejar de inemediato en tu app, <em>tal es la mágia de los observables.</em></p>

<p>En la siguiente parte vamos a convertir esta Task List en un <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements" target="_blank" rel="noopener noreferrer"><em>Custom Element</em></a> lo cual llega al borde de la brujería sin ser brujería en mi opinión.</p>


      </div>
    </div>

    <p class="text-end font-italic">– Anya Reyes</p>
  </div>
  <script src="https://giscus.app/client.js" data-repo="Darkade/Darkade.github.io-comments" data-repo-id="R_kgDOIuNbEA" data-category="Announcements" data-category-id="DIC_kwDOIuNbEM4CTaKd" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_protanopia" data-lang="en" data-loading="lazy" crossorigin="anonymous" async>
</script>

</article>

  </div>
</div>

  </main>
  <footer class="container mt-3">
  <hr class="mb-3">
  <div class="row">
    <div class="col d-flex">
      <ul class="list-inline mx-auto justify-content-center">
        <li class="list-inline-item">
          <a rel="me noopener noreferrer" href="https://dice.camp/@darkade" target="_blank">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#mastodon"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://twitter.com/darkade" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#twitter"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://github.com/darkade" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#github"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://www.linkedin.com/in/" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#linkedin-in"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="/feed.xml">
            <svg class="icon"><use xlink:href="/assets/sprites/solid.svg#rss"></use></svg>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p class="text-center">©2023 Anya Reyes. All rights reserved.</p>
    </div>
  </div>
</footer>

  <!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

</body>
</html>
