<!doctype html>
<html lang="es-MX">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="shortcut icon" href="/assets/icon.png" type="image/x-icon">
  <link rel="shortcut icon" href="/assets/icon_large.png" type="image/png">

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-144585764-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-144585764-1');
  </script>
  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Custom Elements or How I Learned to Stop Worrying and Love the Web Components | General nerdness</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Custom Elements or How I Learned to Stop Worrying and Love the Web Components" />
<meta name="author" content="Anya Reyes" />
<meta property="og:locale" content="es_MX" />
<meta name="description" content="Los web elements son una nueva forma de reutilizar tu código en desarrollo web. ¿Cómo hacerlos?" />
<meta property="og:description" content="Los web elements son una nueva forma de reutilizar tu código en desarrollo web. ¿Cómo hacerlos?" />
<link rel="canonical" href="https://anya.reyescon.de/2019/10/09/web-elements.html" />
<meta property="og:url" content="https://anya.reyescon.de/2019/10/09/web-elements.html" />
<meta property="og:site_name" content="General nerdness" />
<meta property="og:image" content="https://anya.reyescon.de/assets/2019-10-09/custom.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://anya.reyescon.de/assets/2019-10-09/custom.jpg" />
<meta property="twitter:title" content="Custom Elements or How I Learned to Stop Worrying and Love the Web Components" />
<meta name="twitter:site" content="@darkade" />
<meta name="twitter:creator" content="@Anya Reyes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Anya Reyes"},"dateModified":"2019-10-09T00:00:00+00:00","datePublished":"2019-10-09T00:00:00+00:00","description":"Los web elements son una nueva forma de reutilizar tu código en desarrollo web. ¿Cómo hacerlos?","headline":"Custom Elements or How I Learned to Stop Worrying and Love the Web Components","image":"https://anya.reyescon.de/assets/2019-10-09/custom.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://anya.reyescon.de/2019/10/09/web-elements.html"},"url":"https://anya.reyescon.de/2019/10/09/web-elements.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <header>
  <nav class="navbar navbar-dark bg-primary navbar-expand-lg">
    <div class="container-fluid">
      <span class="navbar-text w-50">
        <a class="" href="/">General nerdness</a>
        <span class="d-none d-md-block text-white text-bold"><small>Anya Reyes – Maths, RPGs, Boardgames &amp; Coding.</small></span>
      </span>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggle">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarToggle">
        <ul class="navbar-nav mb-2 mb-lg-0 ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/links/">Links</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/directory/">Directory</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

  <main class="container">
    <div class="row">
  <div class="offset-md-2 col-md-8 py-2">
    <article class="row py-1" lang="es-MX">
  <div class="col">
    <h1 class="my-2 h2"><a href="/2019/10/09/web-elements.html">Custom Elements or How I Learned to Stop Worrying and Love the Web Components</a></h1>
    <p class="text-end">Oct 09, 2019</p>

    <div class="row">
      <div class="col">
        <p><img src="/assets/2019-10-09/custom.jpg" alt="Custom Car"></p>

<p>Un <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" target="_blank" rel="noopener noreferrer"><em>web component</em></a> es una forma de crear tu propio  <em>HTML Custom Element</em> que puede ser utilizado en cualquier sitio web y en la <a href="https://www.webcomponents.org/" target="_blank" rel="noopener noreferrer">mayoría de los browsers</a>. Su funcionalidad esta <em>encapsulada</em> del resto de la página y eso quiere decir que puedes también utilziar los <em>web components</em> de alguien más en tu propio sitio. Hoy vamos a crear un Web Component utilizando Angular Elements.</p>

<!--more-->

<p>Para entender los <em>web components</em> hay que hablar de <a href="https://developer.mozilla.org/en-US/docs/Glossary/Polyfill" target="_blank" rel="noopener noreferrer">Polyfills</a>, el <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noopener noreferrer">Shadow DOM</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/template" target="_blank" rel="noopener noreferrer">HTML5</a> y exactamente qué es un <a href="https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry" target="_blank" rel="noopener noreferrer">Custom Element</a> en términos de Javascript. Afortunadamente para usarlos no necesitas entender mucho de ninguna de esas cosas <img class="emoji" title=":laughing:" alt=":laughing:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png" height="20" width="20"></p>

<h2 id="angular-elements">Angular Elements</h2>

<p><a href="https://angular.io/guide/elements" target="_blank" rel="noopener noreferrer">Angular Elements</a> nos permite empaquetar cualquier Angular Component como un <em>web component.</em> El resultante lo podemos utilizar en cualquier lugar independientemente del resto de la plataforma de Angular.</p>

<p>La ventaja de crear un web component con Angular es que angular se va a encargar de crear los polyfills que necesitamos, vamos a tener acceso a todas las librerías y podemos utilizar Typescript, lo cual siempre es bueno y bonito.</p>

<p>Vamos a empezar con un proyecto nuevo. Si tienes dudas de cómo empezar un proyecto más “tradicional” puedes ver la <a href="/2019/09/27/angular-part-1.html">guía anterior</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ng new tesel-ce <span class="nt">--style</span> scss
<span class="nb">cd </span>tesel-ce
ng add @angular/elements
</code></pre></div></div>

<p>En este caso solo vamos a modificar el componente principal <code class="language-plaintext highlighter-rouge">src/app/app.component.ts</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">ViewEncapsulation</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>

  <span class="c1">//...</span>

  <span class="na">encapsulation</span><span class="p">:</span> <span class="nx">ViewEncapsulation</span><span class="p">.</span><span class="nx">ShadowDom</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppComponent</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div>

<p>La parte importante es el <code class="language-plaintext highlighter-rouge">encapsulation: ViewEncapsulation.ShadowDom</code> Shadow DOM  significa que nuestro componente va a estar aislado del resto del documento HTML dónde lo vamos a integrar. En el sentido práctico quiere decir que puedes usar cualquier class, id, name, css, etc. sin preocuparte de que interfiera con el resto de la página y viceversa.</p>

<p>En <code class="language-plaintext highlighter-rouge">src/app/app.component.html</code> voy a colocar uno de los ejemplos de Bootstrap, porque quiero mostrar cómo el Shadow DOM aisla el componente.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card"</span> <span class="na">style=</span><span class="s">"width: 18rem;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://picsum.photos/400"</span> <span class="na">class=</span><span class="s">"card-img-top"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-body"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h5</span> <span class="na">class=</span><span class="s">"card-title"</span><span class="nt">&gt;</span>Hello World!<span class="nt">&lt;/h5&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"card-text"</span><span class="nt">&gt;</span>Ejemplo de cómo el Shadow DOM nos permite aislar el component.<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"list-group list-group-flush"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"list-group-item"</span><span class="nt">&gt;</span>Cras justo odio<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"card-body"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">class=</span><span class="s">"card-link"</span><span class="nt">&gt;</span>Card link<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Finalmente hay que modificar <code class="language-plaintext highlighter-rouge">src/app/app.module.ts</code>. Nuestro componente ya no a ser un componente <em>bootstrap</em> si no que es un <em>entryComponent</em>. Esto nos permite registrarlo como un <em>Custom Element</em></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">BrowserModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/platform-browser</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span><span class="p">,</span> <span class="nx">Injector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@angular/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createCustomElement</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@angular/elements</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">AppComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./app.component</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>

  <span class="c1">//...</span>

  <span class="na">entryComponents</span><span class="p">:</span> <span class="p">[</span><span class="nx">AppComponent</span><span class="p">]</span> <span class="c1">//  bootstrap: [AppComponent]</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">injector</span><span class="p">:</span> <span class="nx">Injector</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nx">ngDoBootstrap</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">custom</span> <span class="o">=</span> <span class="nx">createCustomElement</span><span class="p">(</span><span class="nx">AppComponent</span><span class="p">,</span> <span class="p">{</span> <span class="na">injector</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">injector</span> <span class="p">});</span>
    <span class="nx">customElements</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="dl">"</span><span class="s2">custom-example</span><span class="dl">"</span><span class="p">,</span> <span class="nx">custom</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Al agregar <code class="language-plaintext highlighter-rouge">@angular/elements</code> tenemos acceso al método <code class="language-plaintext highlighter-rouge">createCustomElement</code> que le permite al DOM reconocer en qué momento se esta mandando a llamar nuestro propio custom element.</p>

<p>Lo único que queda es compilar nuestro componente.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ng build <span class="nt">--prod</span> <span class="nt">--output-hashing</span><span class="o">=</span>none
<span class="nb">cat </span>dist/tesel-ce/<span class="o">{</span>runtime,polyfills,main<span class="o">}</span><span class="nt">-es5</span>.js <span class="o">&gt;</span> tesel-ce.js
</code></pre></div></div>

<p>Lo compilamos en modo de producción porque no hay comments y minimiza el resultado entre otras cosas; lo compilamos sin hashes para hacer más fácil poner nuestro <code class="language-plaintext highlighter-rouge">runtime-es5.js</code>, <code class="language-plaintext highlighter-rouge">polyfills-es5.js</code> y <code class="language-plaintext highlighter-rouge">main-es5.js</code> en el mismo archivo más fácilmente.</p>

<h2 id="la-prueba">La prueba</h2>

<p>Voy a crear un <code class="language-plaintext highlighter-rouge">index.html</code> en cuyo body solo hay estas lineas, y voy a agregar bootstrap para mostrar el efecto del Shadow DOM.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;custom-example&gt;&lt;/custom-example&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"tesel-ce.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Si abres este index en tu browser vas a notar que se despliega todo lo que creamos antes aunque no hay ningún CSS. Esto se debe al Shadow DOM!</p>

<p><img src="/assets/2019-10-09/noformat.png" alt="Angular Element aislado por el Shadow DOM"></p>

<p>Mientras que si colocas el html del <em>custom element</em> en el <code class="language-plaintext highlighter-rouge">index.html</code> se va a mostrar así.</p>

<p><img src="/assets/2019-10-09/format.png" alt="HTML nativo mostrando su CSS"></p>

<p>Una vez más, esto te permite utilizar cualquier clase, estilos y nombres que quieras sin preocuparte.</p>

<hr>

<p>Eso es todo en este post, espero que te ayude a empezar a probar los web elements. Si quieres saber más sobre Angular puedes revisar <a href="/2019/09/27/angular-part-1.html">este post</a>. Y si quieres leer algo más entretenido puedes leer mi post acerca de <a href="/2019/02/07/dice.html">dados</a>.</p>


      </div>
    </div>

    <p class="text-end font-italic">– Anya Reyes</p>
  </div>
  <script src="https://giscus.app/client.js" data-repo="Darkade/Darkade.github.io-comments" data-repo-id="R_kgDOIuNbEA" data-category="Announcements" data-category-id="DIC_kwDOIuNbEM4CTaKd" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_protanopia" data-lang="en" data-loading="lazy" crossorigin="anonymous" async>
</script>

</article>

  </div>
</div>

  </main>
  <footer class="container mt-3">
  <hr class="mb-3">
  <div class="row">
    <div class="col d-flex">
      <ul class="list-inline mx-auto justify-content-center">
        <li class="list-inline-item">
          <a rel="me noopener noreferrer" href="https://dice.camp/@darkade" target="_blank">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#mastodon"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://twitter.com/darkade" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#twitter"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://github.com/darkade" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#github"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="https://www.linkedin.com/in/" target="_blank" rel="noopener noreferrer">
            <svg class="icon"><use xlink:href="/assets/sprites/brands.svg#linkedin-in"></use></svg>
          </a>
        </li>
        <li class="list-inline-item">
          <a href="/feed.xml">
            <svg class="icon"><use xlink:href="/assets/sprites/solid.svg#rss"></use></svg>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <p class="text-center">©2023 Anya Reyes. All rights reserved.</p>
    </div>
  </div>
</footer>

  <!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

</body>
</html>
